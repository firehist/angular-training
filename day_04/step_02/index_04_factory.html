<html>

    <head>
      <script type="text/javascript" src="../../bower_components/angular/angular.js"></script>
      <script type="text/javascript">
        var app = angular.module('app', []);
        app.factory('userService', function ($q, $http) {
          var _privateUser = [];
          return {
            getUser: function () {
              // Cached request
              if (_privateUser.length > 0) {
                var deferred = $q.defer();
                deferred.resolve(_privateUser);
                return deferred.promise;
              }
              return $http.get('/mock/users.json').then(function(res) {
                _privateUser = res.data;
                return _privateUser;
              });
            }
          };
        });
        app.controller('MyController', function (userService) {
          var self = this;
          userService.getUser().then(function(res) {
            self.users = res;
          });
        });

      </script>
    </head>

    <body ng-app="app" ng-controller="MyController as my">

      <h4>Testing Factory</h4>
      <pre>{{ my.users | json }}</pre>

    </body>

</html>
